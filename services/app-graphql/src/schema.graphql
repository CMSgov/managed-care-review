schema {
    query: Query
    mutation: Mutation
}

type Query {
    fetchCurrentUser: User!
    fetchDraftSubmission(
        input: FetchDraftSubmissionInput!
    ): FetchDraftSubmissionPayload!
    fetchStateSubmission(
        input: FetchStateSubmissionInput!
    ): FetchStateSubmissionPayload!

    indexSubmissions: IndexSubmissionsPayload!
}

type Mutation {
    createDraftSubmission(
        input: CreateDraftSubmissionInput!
    ): CreateDraftSubmissionPayload!
    updateDraftSubmission(
        input: UpdateDraftSubmissionInput!
    ): UpdateDraftSubmissionPayload!
    submitDraftSubmission(
        input: SubmitDraftSubmissionInput!
    ): SubmitDraftSubmissionPayload!
}

input CreateDraftSubmissionInput {
    programID: ID!
    submissionType: SubmissionType!
    submissionDescription: String!
}

type CreateDraftSubmissionPayload {
    draftSubmission: DraftSubmission!
}

input FetchDraftSubmissionInput {
    submissionID: ID!
}

type FetchDraftSubmissionPayload {
    draftSubmission: DraftSubmission
}

input FetchStateSubmissionInput {
    submissionID: ID!
}

type FetchStateSubmissionPayload {
    submission: StateSubmission
}

type SubmissionEdge {
    node: Submission!
}

type IndexSubmissionsPayload {
    totalCount: Int
    edges: [SubmissionEdge!]!
}

input UpdateDraftSubmissionInput {
    submissionID: ID!
    draftSubmissionUpdates: DraftSubmissionUpdates!
}

type UpdateDraftSubmissionPayload {
    draftSubmission: DraftSubmission!
}

input SubmitDraftSubmissionInput {
    submissionID: ID!
}

type SubmitDraftSubmissionPayload {
    submission: StateSubmission!
}
scalar Date
scalar DateTime

union User = StateUser | CMSUser

type StateUser {
    role: String!
    email: String!
    state: State!
    name: String!
}

type CMSUser {
    role: String!
    email: String!
    name: String!
}

type State {
    code: String!
    name: String!
    programs: [Program!]!
}

type Program {
    id: ID!
    name: String!
}

type StateContact {
    name: String!
    titleRole: String!
    email: String!
}

input StateContactInput {
    name: String!
    titleRole: String!
    email: String!
}

enum actuarialFirmType {
    MERCER
    MILLIMAN
    OPTUMAS
    GUIDEHOUSE
    DELOITTE
    STATE_IN_HOUSE
    OTHER
}

type ActuaryContact {
    name: String!
    titleRole: String!
    email: String!
    actuarialFirm: actuarialFirmType
    actuarialFirmOther: String
}

input ActuaryContactInput {
    name: String!
    titleRole: String!
    email: String!
    actuarialFirm: actuarialFirmType
    actuarialFirmOther: String
}

enum ActuaryCommunicationType {
    OACT_TO_ACTUARY
    OACT_TO_STATE
}

type Document {
    name: String!
    s3URL: String!
}

input DocumentInput {
    name: String!
    s3URL: String!
}

type CapitationRatesAmendedInfo {
    reason: CapitationRatesAmendmentReason
    otherReason: String
}

input CapitationRatesAmendedInfoInput {
    reason: CapitationRatesAmendmentReason
    otherReason: String
}

type ContractAmendmentInfo {
    itemsBeingAmended: [String!]!
    otherItemBeingAmended: String
    capitationRatesAmendedInfo: CapitationRatesAmendedInfo
    relatedToCovid19: Boolean
    relatedToVaccination: Boolean
}

input ContractAmendmentInfoInput {
    itemsBeingAmended: [String!]!
    otherItemBeingAmended: String
    capitationRatesAmendedInfo: CapitationRatesAmendedInfoInput
    relatedToCovid19: Boolean
    relatedToVaccination: Boolean
}

enum CapitationRatesAmendmentReason {
    ANNUAL
    MIDYEAR
    OTHER
}

type RateAmendmentInfo {
    effectiveDateStart: Date
    effectiveDateEnd: Date
}

input RateAmendmentInfoInput {
    effectiveDateStart: Date
    effectiveDateEnd: Date
}

enum SubmissionType {
    CONTRACT_ONLY
    CONTRACT_AND_RATES
}

enum ContractType {
    BASE
    AMENDMENT
}

enum RateType {
    NEW
    AMENDMENT
}

enum FederalAuthority {
    STATE_PLAN
    WAIVER_1915B
    WAIVER_1115
    VOLUNTARY
    BENCHMARK
    TITLE_XXI
}

type DraftSubmission {
    id: ID!
    programID: String!
    program: Program!
    submissionType: SubmissionType!
    submissionDescription: String!
    stateCode: String!
    name: String!
    createdAt: Date!
    updatedAt: DateTime!
    stateContacts: [StateContact!]!
    actuaryContacts: [ActuaryContact!]!
    actuaryCommunicationPreference: ActuaryCommunicationType
    documents: [Document!]!
    contractType: ContractType
    contractDateStart: Date
    contractDateEnd: Date
    managedCareEntities: [String!]!
    federalAuthorities: [FederalAuthority!]!
    contractAmendmentInfo: ContractAmendmentInfo
    rateType: RateType
    rateDateStart: Date
    rateDateEnd: Date
    rateDateCertified: Date
    rateAmendmentInfo: RateAmendmentInfo
}

type StateSubmission {
    id: ID!
    programID: String!
    program: Program!
    submissionType: SubmissionType!
    submissionDescription: String!
    stateCode: String!
    name: String!
    createdAt: Date!
    updatedAt: DateTime!
    stateContacts: [StateContact!]!
    actuaryContacts: [ActuaryContact!]!
    actuaryCommunicationPreference: ActuaryCommunicationType
    documents: [Document!]!
    contractAmendmentInfo: ContractAmendmentInfo
    submittedAt: DateTime!
    contractType: ContractType!
    contractDateStart: Date!
    contractDateEnd: Date!
    managedCareEntities: [String!]!
    federalAuthorities: [FederalAuthority!]!
    rateType: RateType
    rateDateStart: Date
    rateDateEnd: Date
    rateDateCertified: Date
    rateAmendmentInfo: RateAmendmentInfo
}

union Submission = DraftSubmission | StateSubmission

input DraftSubmissionUpdates {
    programID: String!
    submissionType: SubmissionType!
    submissionDescription: String!
    stateContacts: [StateContactInput!]!
    actuaryContacts: [ActuaryContactInput!]!
    actuaryCommunicationPreference: ActuaryCommunicationType
    documents: [DocumentInput!]!
    contractType: ContractType
    contractDateStart: Date
    contractDateEnd: Date
    managedCareEntities: [String!]!
    federalAuthorities: [FederalAuthority!]!
    contractAmendmentInfo: ContractAmendmentInfoInput
    rateType: RateType
    rateDateStart: Date
    rateDateEnd: Date
    rateDateCertified: Date
    rateAmendmentInfo: RateAmendmentInfoInput
}
